---
title: Customer Analysis
---

# ğŸ‘¥ Customer Analysis

This page analyzes customer spending and rental activity in the **Sakila** movie rental database.  
We explore who the top customers are, how much they spend, and how frequently they rent films.

---

## ğŸ† Top 10 Customers by Total Spending

The table below shows the top 10 customers ranked by:

- **Total amount spent**
- **Number of rentals**


```sql rental
SELECT
    customer,
    SUM(amount) AS total_amount,
    COUNT(*) AS number_of_rentals
FROM sakila.rental
group by customer_id, customer
order by total_amount desc, number_of_rentals desc
limit 10
;
```

<BarChart
    data={rental}
    title="Top customers in order of how much they have spent"
    x=customer
    y=total_amount
    swapXY= true
/>

--- 

## ğŸ¬ Spending per Store

The chart below shows the total revenue generated by each store.  
This helps understand which location performs better in terms of customer spending.

```sql spending_by_store
SELECT
    store_id,
    SUM(amount) AS total_revenue
FROM sakila.rental
GROUP BY store_id
ORDER BY store_id;
```
<BarChart 
    data={spending_by_store} 
    title="Total Spending per Store"
    x="store_id" 
    y="total_revenue" 
/>

---

# âœ… **2. Customer Segmentation (Low / Medium / High Spenders)**

Customers are grouped into three spending categories:

- **High Spenders**: more than $200  
- **Medium Spenders**: between $100 and $200  
- **Low Spenders**: less than $100  

```sql customer_segments
SELECT 
    segment,
    COUNT(*) AS num_customers
FROM (
    SELECT
        customer,
        SUM(amount) AS total_spent,
        CASE 
            WHEN SUM(amount) > 200 THEN 'High'
            WHEN SUM(amount) >= 100 AND SUM(amount) <= 200 THEN 'Medium'
            ELSE 'low'
        END AS segment
    FROM sakila.rental
    GROUP BY customer_id, customer
)
GROUP BY segment
ORDER BY num_customers DESC;
```

<BarChart 
    data={customer_segments}
    title="Customer Segments (Low / Medium / High Spenders)" 
    x="segment"
    y="num_customers"
/>